(self.webpackChunkmerch_store=self.webpackChunkmerch_store||[]).push([[454],{454:(p,l,r)=>{"use strict";r.r(l),r.d(l,{default:()=>F});var i=r(1635);var d=r(5206),A=r.n(d),h=r(2864),o=r(5152),t=r(4438),v=r(6878),O=r(8141),m=r(9079),y=r(4710),P=r(653),R=r(1413),b=r(7673),T=r(9172),Q=r(5558),W=r(6354);let C=class{api=(0,t.WQX)(o.Gf);route=(0,t.WQX)(y.nX);refetchTrigger=new R.B;getFilterOptions(){return{brandIds:this.getBrandOptions(),gender:this.getGenderOptions(),sortBy:this.getSortingOptions()}}refetchFilterOptions(){this.refetchTrigger.next(!0)}getBrandOptions(){return this.refetchTrigger.asObservable().pipe((0,T.Z)(1),(0,Q.n)(()=>this.api.get("BrandCategory/GetCategoryBrands",{categoryId:this.route.snapshot.params.id})),(0,W.T)(e=>e.map(s=>({label:s.name,value:s.id}))))}getGenderOptions(){return(0,b.of)(P.nL.map(e=>({label:e,value:e})))}getSortingOptions(){return(0,b.of)(P.JH)}};C=(0,i.Cg)([(0,t._qm)({providedIn:"root"})],C);var S=r(5172);let f=class{productDataService=(0,t.WQX)(S.D);destroyRef=(0,t.WQX)(t.abz);route=(0,t.WQX)(y.nX);isTablet=(0,t.WQX)(o.RL).isTablet;userService=(0,t.WQX)(o.DL);currCategoryId=(0,t.EWP)(()=>[...this.categories()].pop()?.id);currCategoryName=(0,t.EWP)(()=>[...this.categories()].pop()?.name);title=this.currCategoryName;subtitle=(0,t.vPA)("");filters=(0,t.vPA)(["brandIds","sortBy","isAvailablePointsRange"]);products=(0,t.vPA)([]);isLoading=(0,t.vPA)(!1);totalCount=(0,t.vPA)(0);lastReceivedPageNumber=(0,t.vPA)(0);lastReceivedCategoryId=(0,t.vPA)(null);productsPerPage=(0,t.EWP)(()=>this.isTablet()?6:8);productsOffset=(0,t.vPA)(this.productsPerPage());filterState=(0,t.vPA)({});cachedFilter={};categories=(0,m.ot)(this.route.queryParams.pipe((0,W.T)(e=>e.data?JSON.parse(e.data):[])));getProducts(e){if(!Object.keys(e).length)return;this.isLoading.set(!0);const s=JSON.stringify(this.cachedFilter)!==JSON.stringify(e);s&&(this.lastReceivedPageNumber.set(0),this.cachedFilter=e);const n=X(this.currCategoryId(),this.lastReceivedCategoryId());n&&this.lastReceivedCategoryId.set(this.currCategoryId());const{sortBy:E,...c}=e;this.productDataService.getProducts({...c,brandIds:Array.isArray(c.brandIds)?c.brandIds:[c.brandIds],categoryIds:Array.isArray(this.currCategoryId())?this.currCategoryId():[this.currCategoryId()],sortBy:E,page:s?1:Math.min(this.lastReceivedPageNumber()+1,this.totalCount()),pageSize:this.productsPerPage(),...e.pointsTo?{pointsFrom:0,pointsTo:this.userService.balance().points}:{}}).pipe((0,m.pQ)(this.destroyRef)).subscribe(g=>{this.products.update(x=>s||n?g.items:[...x,...g.items]),this.totalCount.set(g.totalCount),this.lastReceivedPageNumber.set(g.currentPage),this.isLoading.set(!1)})}seeMoreProducts(){this.getProducts(this.cachedFilter||{})}};f=(0,i.Cg)([(0,t._qm)({providedIn:"root"})],f);const X=(a,e)=>Array.isArray(a)&&Array.isArray(e)?!L(a,e):a!==e,L=(a,e)=>a.length===e.length&&a.every((s,n)=>s===e[n]);var D=r(177),N=r(3963);let I=class{productService=(0,t.WQX)(o.bk);cartService=(0,t.WQX)(o.mx);route=(0,t.WQX)(y.nX);breadcrumbsService=(0,t.WQX)(h.EH);wishlistService=(0,t.WQX)(o.FQ);productListService=(0,t.WQX)(v.I);destroyRef=(0,t.WQX)(t.abz);dataService=(0,t.WQX)(S.D);categoryId=(0,t.EWP)(()=>{const e=this.route.snapshot.paramMap.get("id");return e?parseInt(e,10):null});constructor(){(0,t.QZP)(()=>{this.dataService.getCategoriesForBreadcrumb(this.categoryId()).subscribe(e=>{const s=(0,P.Dp)(e);this.breadcrumbsService.set([...(0,N.TN)(s)])})},{allowSignalWrites:!0})}ngOnInit(){this.route.params.pipe((0,O.M)(e=>this.productListService.getProducts({})),(0,m.pQ)(this.destroyRef)).subscribe()}toggleWishlist(e){this.wishlistService.toggleWishlist(e)}addToCart(e){this.cartService.addCartProduct(e)}onShowProduct(e){this.productService.goToProductDetails(e)}static ctorParameters=()=>[]};I=(0,i.Cg)([(0,t.uAl)({selector:"app-category-products",template:'<app-breadcrumbs></app-breadcrumbs>\n<app-product-list\n  (onShowProduct)="onShowProduct($event)"\n  (toggleWishlist)="toggleWishlist($event)"\n  (addToCart)="addToCart($event)"\n  [emptyListTemplate]="emptyWishlistTemplate"\n></app-product-list>\n\n<ng-template #emptyWishlistTemplate>\n  <div class="">\n    <p class="body-0 text-center">No products found according to applied filters</p>\n  </div>\n</ng-template>\n',standalone:!0,changeDetection:t.Ngq.OnPush,imports:[D.MD,h.m6,v.t],providers:[S.D,{provide:h.xs,useClass:C},{provide:v.I,useClass:f}],styles:[A()]}),(0,i.Sn)("design:paramtypes",[])],I);const F=I},5206:(p,l,r)=>{var i=r(8564),d=r(8557)(i);d.push([p.id,":host {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 2rem;\n}\n@media (min-width: 0) and (max-width: 480px) {\n  :host {\n    padding: 0.5rem;\n    padding-top: 2rem;\n  }\n}",""]),p.exports=d.toString()}}]);